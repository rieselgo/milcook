# プロダクトビジョンとPRD - 粉ミルク調乳タイマー

## プロダクトビジョン

**「科学的根拠に基づき、育児中の親をサポートする、最も正確で使いやすい調乳タイマー」**

---

## エグゼクティブサマリー

### 解決する課題
1. **待ち時間の不確実性**: 調乳後、いつ適温になるか分からず赤ちゃんを泣かせてしまう
2. **温度管理の難しさ**: 熱すぎても冷めすぎても授乳できない
3. **材質・方法による差**: 哺乳瓶の材質や冷却方法で時間が大きく異なるが予測困難

### ソリューション
熱力学計算に基づいた**科学的に正確な温度予測タイマー**
- ニュートンの冷却法則を用いた正確な温度計算
- 材質別（ガラス/プラスチック/PPSU）のパラメータ対応
- 5つの冷却方法の最適化提案

### ターゲットユーザー
- **プライマリ**: 0-12ヶ月の赤ちゃんを持つ親（特に夜間授乳をしている）
- **セカンダリ**: 科学的根拠に基づいた育児を志向する保護者

---

## Phase 1: MVP（最小機能製品）

**目標**: 基本的な調乳タイマー機能を提供

### 必須機能

#### 1.1 初期設定
- [ ] ミルク量選択: 100ml / 120ml / 140ml / 160ml / 200ml / 240ml
- [ ] 哺乳瓶材質選択: ガラス / プラスチック / PPSU
- [ ] 湯冷まし温度設定: 冷蔵庫(5°C) / 常温(20°C) / カスタム
- [ ] 目標温度設定: 36°C / 38°C / 40°C（スライダー調整）
- [ ] 室温設定: 15°C〜30°C（スライダー調整）

**実装詳細**:
- 設定は localStorage に保存
- 前回の設定を記憶してクイックスタート可能
- デフォルト値: 140ml, ガラス, 38°C

#### 1.2 調乳ガイド（ステップバイステップ）
- [ ] Step 1: お湯の量を計算・表示（例: 85°Cのお湯 80ml）
- [ ] Step 2: 湯冷ましの量を計算・表示（例: 湯冷まし 60ml）
- [ ] Step 3: 予測混合温度を表示（例: 約46.6°C）
- [ ] Step 4: 冷却方法選択画面へ遷移

**計算式**:
```
混合温度 = (お湯の温度 × お湯の量 + 湯冷ましの温度 × 湯冷ましの量) / 総量
```

#### 1.3 冷却方法選択
5つの冷却方法から選択（優先順位順）:

1. **氷水攪拌** ⭐推奨
   - 予測時間: 約53秒（ガラス瓶、140ml、46.6°C→38°C）
   - メリット: 速い、節水、実用的
   - デメリット: 手動で揺らす必要

2. **氷水静置**
   - 予測時間: 約3分
   - メリット: 放置できる
   - デメリット: 時間がかかる

3. **流水冷却**
   - 予測時間: 約40秒
   - メリット: 最速クラス
   - デメリット: 水道代がかかる

4. **氷水+流水**
   - 予測時間: 約25秒
   - メリット: 最速
   - デメリット: 水がもったいない

5. **常温放置**
   - 予測時間: 約34分
   - メリット: 何もしなくて良い
   - デメリット: 遅すぎる（非推奨）

**表示内容**:
- 予測時間
- メリット・デメリット
- おすすめマーク（氷水攪拌）

#### 1.4 タイマー実行画面（シンプル版）
- [ ] 経過時間表示（カウントアップ）
- [ ] 現在温度表示（リアルタイム計算、1秒更新）
- [ ] 目標温度までの差分表示
- [ ] 一時停止/再開/終了ボタン

**熱力学計算**:
```typescript
// ニュートンの冷却法則
T(t) = T_ambient + (T_initial - T_ambient) * exp(-k * t)

// k: 冷却定数（材質・方法による）
// t: 経過時間（分）
```

#### 1.5 適温アラート
- [ ] 目標温度±1°Cで音声通知
- [ ] バイブレーション（3回振動）
- [ ] 通知ON/OFF設定

**振動パターン**:
```
200ms振動 - 100ms休止 - 200ms振動 - 100ms休止 - 200ms振動
```

### 除外機能（Phase 2以降）
- 哺乳瓶アニメーション
- 温度グラフ
- 履歴保存
- 統計表示

### 成功指標（MVP）
- タイマー予測精度: 実測値との誤差±10秒以内（80%以上）
- 完了率: 調乳開始からタイマー完了まで80%以上
- 初回起動から調乳開始まで: 30秒以内

---

## Phase 2: ビジュアル強化

**目標**: ユーザー体験を向上させる視覚的フィードバック

### 必須機能

#### 2.1 哺乳瓶SVGアニメーション
- [ ] SVGベースの哺乳瓶イラスト
- [ ] 温度に応じた色変化（グラデーション）
  - 50°C以上: 濃いオレンジ (#FF6B35)
  - 45-50°C: オレンジ (#FF8C42)
  - 40-45°C: 薄いオレンジ (#FFB84D)
  - 38-40°C: イエロー (#FFF066)
  - 38°C以下: グリーン (#4CAF50)
- [ ] スムーズなトランジション（1秒ごと）
- [ ] 液面の波のアニメーション

#### 2.2 温度グラフ
- [ ] 時間（横軸）× 温度（縦軸）のリアルタイムグラフ
- [ ] 予測曲線の表示
- [ ] 現在位置のマーカー
- [ ] Chart.js を使用

#### 2.3 進捗バー・冷却速度メーター
- [ ] 目標温度までの進捗（パーセント表示）
- [ ] スムーズなアニメーション
- [ ] 冷却速度（°C/分）のリアルタイム表示

#### 2.4 ダークモード対応
- [ ] システム設定に応じた自動切り替え
- [ ] 手動切り替えオプション
- [ ] 夜間授乳での目の負担軽減

### 成功指標
- ユーザー満足度: 4.5/5以上
- タイマー画面の滞在時間: 90%以上（途中離脱を減らす）

---

## Phase 3: 氷水攪拌モード特化

**目標**: 最推奨の冷却方法を使いやすく

### 必須機能

#### 3.1 揺らしリマインダー
- [ ] 15秒ごとにバイブレーション通知
- [ ] 「揺らしてください」視覚的表示
- [ ] カウントダウン表示（次の揺らしまで）

#### 3.2 揺らしボタン・カウンター
- [ ] 揺らしたことを記録するボタン
- [ ] 揺らした回数のカウント表示
- [ ] タップでフィードバック（波紋エフェクト）

#### 3.3 ガイドアニメーション
- [ ] 揺らし方のデモアニメーション
- [ ] 初回利用時のチュートリアル

### 成功指標
- 氷水攪拌の利用率: 60%以上
- 揺らし忘れ率: 10%以下

---

## Phase 4: 履歴・学習機能

**目標**: 使うほど精度が向上

### 必須機能

#### 4.1 履歴保存（IndexedDB）
- [ ] 調乳セッションの記録
  - 日時
  - ミルク量
  - 材質
  - 冷却方法
  - 予測時間 vs 実測時間
  - 揺らした回数
- [ ] 最大保存件数: 100件（古いものから削除）

#### 4.2 統計画面
- [ ] 平均調乳時間
- [ ] 冷却方法別の使用頻度
- [ ] 成功率（目標温度到達率）
- [ ] よく使うミルク量

#### 4.3 実測値との比較
- [ ] 予測と実測の誤差グラフ
- [ ] 誤差の傾向分析

#### 4.4 環境補正機能
- [ ] 実測データから環境係数を学習
- [ ] 冷却定数の自動調整（±10%範囲内）
- [ ] 3回以上の実測で補正開始

### 成功指標
- 予測精度（補正後）: 誤差±5秒以内（90%以上）
- 履歴閲覧率: 20%以上

---

## Phase 5: PWA化・最適化

**目標**: ネイティブアプリのような体験

### 必須機能

#### 5.1 Service Worker実装
- [ ] オフライン動作（全機能）
- [ ] キャッシュ戦略
  - アプリシェル: Cache First
  - 設定データ: Network First

#### 5.2 プッシュ通知
- [ ] Web Push API で適温通知
- [ ] バックグラウンドでの通知
- [ ] 通知パーミッションのリクエスト

#### 5.3 インストールプロンプト
- [ ] ホーム画面追加の案内
- [ ] インストール後の初回起動ガイド

#### 5.4 パフォーマンス最適化
- [ ] Lighthouse スコア 90点以上
- [ ] 初期ロード時間: 3秒以内
- [ ] タイマー更新: 正確に1秒ごと
- [ ] バッテリー消費の最適化

### 成功指標
- PWAインストール率: 30%以上
- オフライン利用率: 10%以上

---

## Phase 6: 追加機能

**目標**: より便利に、より使いやすく

### オプション機能

#### 6.1 準備リストチェックリスト
- [ ] 保冷剤の準備リマインダー
- [ ] ボウルの準備チェック
- [ ] 湯冷ましの準備チェック

#### 6.2 保冷剤リマインダー
- [ ] 定期的な凍結リマインダー
- [ ] ローカル通知

#### 6.3 音声ガイド（オプション）
- [ ] 各ステップの音声読み上げ
- [ ] 適温到達時の音声通知

#### 6.4 多言語対応
- [ ] 英語
- [ ] 中国語（簡体字）
- [ ] i18n対応

#### 6.5 マルチユーザー対応
- [ ] ユーザープロフィール
- [ ] 赤ちゃんごとの設定
- [ ] クラウド同期（Firebase）

---

## 非機能要件

### パフォーマンス
- 初期ロード時間: 3秒以内
- タイマー更新: 1秒ごと（正確に）
- アニメーション: 60fps維持

### 互換性
- iOS Safari 14+
- Android Chrome 90+
- モダンブラウザ（Chrome, Safari, Edge, Firefox 最新2バージョン）

### アクセシビリティ
- WCAG 2.1 AA準拠
- スクリーンリーダー対応
- キーボード操作可能
- カラーコントラスト比 4.5:1以上

### セキュリティ
- HTTPS必須
- XSS対策
- 機密情報の暗号化（将来の拡張用）

---

## ロードマップ

```
Phase 0: ドキュメント整備（1週間）
  └─ 完了条件: 全ドキュメント作成、規約整備

Phase 1: MVP（3週間）
  └─ 完了条件: 基本タイマー機能、精度±10秒

Phase 2: ビジュアル強化（2週間）
  └─ 完了条件: アニメーション、グラフ実装

Phase 3: 氷水攪拌特化（1週間）
  └─ 完了条件: 揺らしリマインダー実装

Phase 4: 履歴・学習（2週間）
  └─ 完了条件: IndexedDB実装、統計画面

Phase 5: PWA化（1週間）
  └─ 完了条件: オフライン動作、Lighthouse 90+

Phase 6: 追加機能（随時）
  └─ ユーザーフィードバックに基づく拡張
```

---

## リスクと対策

### 技術的リスク
| リスク | 影響 | 対策 |
|--------|------|------|
| 温度予測の精度不足 | 高 | 実測データ収集、補正機能 |
| バイブレーション非対応ブラウザ | 中 | フォールバック（音声通知） |
| バックグラウンドタイマーの制約 | 中 | Web Worker使用 |

### ビジネスリスク
| リスク | 影響 | 対策 |
|--------|------|------|
| ユーザー獲得困難 | 高 | SNSマーケティング、口コミ |
| 競合アプリの登場 | 中 | 独自性（科学的根拠）を強調 |

---

このPRDに基づき、各Phaseを順次実装していきます。
