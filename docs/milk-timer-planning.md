# 粉ミルク調乳タイマーアプリ 企画書 v2.0

## 🎯 コンセプト

**「科学的根拠に基づいた、正確で使いやすい調乳タイマー」**

熱力学シミュレーションを活用し、哺乳瓶の材質や冷却方法に応じた正確な温度予測とタイマー機能を提供。
育児中の親が赤ちゃんを待たせず、適温のミルクを安全に作れるようサポートする。

---

## 📱 アプリの主要機能

### 1. 初期設定・カスタマイズ
- **ミルク量の選択**: 100ml / 120ml / 140ml / 160ml / 200ml / 240ml
- **哺乳瓶の材質**: ガラス / プラスチック / PPSU
- **湯冷ましの温度**: 冷蔵庫(5°C) / 常温(20°C) / カスタム
- **目標温度**: 36°C / 38°C / 40°C（体温に近い温度帯）
- **室温**: 15°C〜30°C（スライダー調整）

### 2. 調乳ガイド（ステップバイステップ）
- **Step 1**: お湯の量を表示（例: 85°Cのお湯 80ml）
- **Step 2**: 湯冷ましの量を表示（例: 湯冷まし 60ml）
- **Step 3**: 予測混合温度を表示（例: 約46.6°C）
- **Step 4**: 冷却方法の選択へ

### 3. 冷却方法の選択と最適化提案 ⭐NEW

#### 5つの冷却方法（ガラス瓶の場合）
1. **氷水攪拌** ⭐推奨
   - 予測時間: 約53秒
   - 節水で速い、実用的
   - 15秒ごとに「軽く揺らしてください」通知

2. **氷水静置**
   - 予測時間: 約3分
   - 放置できて楽
   - 他の準備をしながら待てる

3. **流水冷却**
   - 予測時間: 約40秒
   - 最速クラス
   - 水道代がかかる

4. **氷水+流水**
   - 予測時間: 約25秒
   - 最速
   - 水がもったいない

5. **常温放置**
   - 予測時間: 約34分
   - 非推奨（遅すぎる）

#### 準備サポート機能
- **保冷剤リマインダー**: 「保冷剤を2-3個凍らせておきましょう」
- **ボウル準備ガイド**: 「水を入れたボウルに保冷剤を入れてください」
- **節水モード**: 氷水方式を優先提案

### 4. リアルタイムタイマー ⭐大幅改良

#### ビジュアル表現（体験重視の設計）
- **哺乳瓶イラストアニメーション**
  - 温度に応じてグラデーション変化
  - 46°C: 濃いオレンジ色 🟠
  - 40°C: 薄いオレンジ色 🟡
  - 38°C: グリーン色 🟢
  - ミルクの液面が徐々に冷たい色に変わる

- **温度の数値表示**
  - リアルタイム計算による温度更新（1秒ごと）
  - 大きく見やすいフォント
  - 現在温度と目標温度の差を表示

- **冷却グラフ**
  - 時間と温度の関係を可視化
  - 現在位置をマーカーで表示
  - 予測曲線と実測値の比較

- **進捗バー**
  - 目標温度までの進捗をパーセント表示
  - スムーズなアニメーション

- **冷却速度メーター**
  - °C/分をリアルタイム表示
  - 速度に応じてメーターの色が変化

#### インタラクティブ要素
- **氷水攪拌モード専用機能**
  - 15秒ごとに「揺らしてください」バイブレーション
  - 揺らしボタンをタップで記録
  - 揺らし回数カウンター

- **タイマーコントロール**
  - カウントアップタイマー（経過時間）
  - 一時停止・再開
  - リセット

### 5. アラート機能
- **適温通知**: 目標温度±1°Cで通知
- **バイブレーション**: 適温到達時に3回振動
- **音声通知**: ON/OFF切り替え可能
- **事前通知**: 「あと30秒で適温です」（カスタマイズ可能）
- **揺らしリマインダー**: 氷水攪拌モード時に15秒ごと

### 6. 履歴・学習機能
- **調乳履歴の記録**: 日時、温度、冷却方法、実際の時間
- **実測値との比較**: シミュレーションとの誤差を記録
- **環境学習**: 使用環境に応じた補正値の自動調整
- **統計表示**: 
  - 平均調乳時間
  - 最頻使用の冷却方法
  - 冷却方法別の成功率
  - よく使うミルク量

---

## 🎨 UI/UX設計

### デザインコンセプト
**「夜中でも見やすい、片手で操作できる、迷わない、温度変化が直感的」**

#### カラースキーム
- **温度表現**
  - 50°C以上: 濃いオレンジ (#FF6B35)
  - 45-50°C: オレンジ (#FF8C42)
  - 40-45°C: 薄いオレンジ (#FFB84D)
  - 38-40°C: イエロー (#FFF066)
  - 38°C以下: グリーン (#4CAF50)
- **プライマリ**: ブルー系（冷却を連想）
- **ダークモード対応**: 夜間授乳での目の負担軽減

### 画面構成

#### 1. ホーム画面
```
┌─────────────────────┐
│  🍼 調乳タイマー      │
├─────────────────────┤
│                     │
│  [新しく調乳する]    │
│                     │
│  クイックスタート    │
│  (140ml, ガラス瓶,   │
│   氷水攪拌)          │
│                     │
├─────────────────────┤
│  📊 履歴             │
│  ⚙️  設定             │
│  💡 準備リスト        │
└─────────────────────┘
```

#### 2. 準備リスト画面 ⭐NEW
```
┌─────────────────────┐
│  事前準備チェックリスト│
├─────────────────────┤
│  □ 保冷剤を2-3個     │
│    冷凍庫で凍らせる   │
│                     │
│  □ ボウルを用意      │
│    (哺乳瓶が浸かる   │
│     深さのもの)      │
│                     │
│  □ 湯冷ましを用意    │
│    (冷蔵庫で冷やす)  │
│                     │
│  [準備完了]          │
└─────────────────────┘
```

#### 3. 設定画面（カードUI）
```
┌─────────────────────┐
│  ミルク量             │
│  ○ 100ml  ● 140ml   │
│  ○ 160ml  ○  200ml   │
├─────────────────────┤
│  哺乳瓶の材質         │
│  ● ガラス  ○ PPSU   │
│  ○ プラスチック      │
├─────────────────────┤
│  湯冷まし温度         │
│  ● 冷蔵庫(5°C)       │
│  ○ 常温(20°C)        │
├─────────────────────┤
│  目標温度            │
│  🌡️ 38°C  [スライダー]│
└─────────────────────┘
```

#### 4. 調乳ガイド画面（ステップ表示）
```
┌─────────────────────┐
│  Step 1/3           │
│                     │
│     ☕ 85°Cのお湯     │
│                     │
│       80 ml         │
│     =========       │
│                     │
│  粉ミルクを溶かします │
│                     │
│  [完了 →]           │
└─────────────────────┘
```

#### 5. 冷却方法選択画面 ⭐更新
```
┌─────────────────────┐
│  混合完了！           │
│  現在温度: 46.6°C    │
│  目標温度: 38.0°C    │
├─────────────────────┤
│  🧊⭐ 氷水攪拌       │
│  予測: 53秒          │
│  💚 おすすめ         │
│  [詳細を見る]        │
├─────────────────────┤
│  🧊 氷水静置         │
│  予測: 3分           │
│  放置できて楽        │
├─────────────────────┤
│  🌊 流水冷却         │
│  予測: 40秒          │
│  速いが水道代        │
├─────────────────────┤
│  その他の方法を見る ▼ │
└─────────────────────┘
```

#### 6. タイマー実行画面（メイン）⭐大幅改良
```
┌─────────────────────┐
│  経過時間 0:23       │
├─────────────────────┤
│                     │
│      🍼              │
│     ┌───┐           │
│     │🟠🟠│  46.6°C   │
│     │🟠🟠│           │
│     │🟡🟡│  目標38°C │
│     │░░░│  まで8.6° │
│     └───┘           │
│                     │
│  ████████░░░░ 65%   │
│                     │
│  冷却速度: -10.7°C/分│
│                     │
├─────────────────────┤
│  [温度グラフ]        │
│   50°┐              │
│      │●╲           │
│   45°│  ╲          │
│      │   ●現在      │
│   40°│     ╲        │
│   38°├──────●目標   │
│      0  0.5  1  分  │
├─────────────────────┤
│  氷水攪拌モード      │
│  次の揺らし: 12秒後  │
│  [揺らした！] 🤝 3回 │
├─────────────────────┤
│  [一時停止] [終了]   │
└─────────────────────┘
```

#### 7. 適温到達画面
```
┌─────────────────────┐
│                     │
│       ✅            │
│   適温になりました！  │
│                     │
│      🍼             │
│     ┌───┐           │
│     │🟢🟢│  38.2°C   │
│     │🟢🟢│           │
│     │🟢🟢│           │
│     └───┘           │
│                     │
│  実際の時間: 0:51    │
│  予測: 0:53 (誤差2秒)│
│                     │
│  必ず腕の内側で      │
│  温度確認をして      │
│  ください           │
│                     │
│  [記録する] [終了]   │
└─────────────────────┘
```

---

## 🎬 アニメーション・インタラクション詳細

### 哺乳瓶ビジュアル
- **SVGベースの哺乳瓶イラスト**
- **グラデーション効果**
  - 上から下へ温度に応じたグラデーション
  - 時間経過で下から冷たい色に変化
  - スムーズなトランジション（1秒ごと）

### 温度変化アニメーション
```javascript
// 擬似コード
temperature = 46.6;
targetTemp = 38;

setInterval(() => {
  // 熱力学計算で温度更新
  temperature = calculateTemp(elapsedTime);
  
  // 色の補間計算
  color = interpolateColor(temperature);
  
  // 哺乳瓶の色を更新
  updateBottleColor(color);
}, 1000);
```

### マイクロインタラクション
- **揺らしボタン**: タップで波紋エフェクト
- **温度到達**: 緑の波紋が広がるアニメーション
- **進捗バー**: スムーズに伸びる
- **グラフのライン**: リアルタイムで描画される

---

## 🔧 技術仕様案

### フロントエンド
- **フレームワーク**: React / Next.js + TypeScript
- **UI**: Tailwind CSS + shadcn/ui
- **状態管理**: Zustand（軽量でシンプル）
- **アニメーション**: Framer Motion
- **グラフ**: Recharts（温度グラフ用）
- **SVG操作**: react-svg（哺乳瓶イラスト）

### 計算エンジン
```typescript
// 熱力学計算モジュール
interface BottleMaterial {
  thermalConductivity: number;
  thickness: number;
  density: number;
  specificHeat: number;
}

interface CoolingMethod {
  ambientTemp: number;
  heatTransferCoefficient: number;
}

function calculateTemperature(
  initialTemp: number,
  elapsedTime: number,
  bottle: BottleMaterial,
  method: CoolingMethod
): number {
  // 熱力学計算の実装
  // ニュートンの冷却法則 + 熱伝達係数
}
```

### データ構造
```typescript
interface MilkSession {
  id: string;
  timestamp: Date;
  volume: number;
  bottleMaterial: 'glass' | 'plastic' | 'ppsu';
  coolingMethod: 'ice_stir' | 'ice_still' | 'running_water' | 'air';
  targetTemp: number;
  initialTemp: number;
  actualTime: number;
  predictedTime: number;
  stirCount?: number; // 氷水攪拌の場合
}
```

### PWA対応
- **オフライン動作**: Service Worker
- **プッシュ通知**: Web Push API（適温通知）
- **バイブレーション**: Vibration API
- **インストール可能**: manifest.json
- **バックグラウンドタイマー**: Web Worker

### ストレージ
- **ローカル**: IndexedDB（履歴保存）
- **設定**: localStorage（ユーザー設定）
- **クラウド同期（将来）**: Firebase / Supabase

---

## 📊 開発ロードマップ

### Phase 1: MVP（最小機能製品）2-3週間
- [ ] 熱力学計算エンジン実装
  - [ ] 5つの冷却方法の計算式
  - [ ] 材質別パラメータ
  - [ ] 単体テスト
- [ ] 基本UI実装
  - [ ] 設定画面
  - [ ] 冷却方法選択画面
  - [ ] タイマー実行画面（シンプル版）
- [ ] リアルタイム温度計算
- [ ] 適温アラート（音・バイブ）

### Phase 2: ビジュアル強化 2週間
- [ ] 哺乳瓶SVGアニメーション
  - [ ] 温度に応じた色変化
  - [ ] スムーズなトランジション
- [ ] 温度グラフ実装
- [ ] 進捗バー・冷却速度メーター
- [ ] マイクロインタラクション追加
- [ ] ダークモード対応

### Phase 3: 氷水攪拌モード特化 1週間
- [ ] 揺らしリマインダー（15秒ごと）
- [ ] 揺らしボタン・カウンター
- [ ] バイブレーション最適化
- [ ] ガイドアニメーション

### Phase 4: 履歴・学習機能 2週間
- [ ] IndexedDBでの履歴保存
- [ ] 統計画面
- [ ] 実測値との比較
- [ ] 環境補正機能
- [ ] エクスポート機能

### Phase 5: PWA化・最適化 1週間
- [ ] Service Worker実装
- [ ] プッシュ通知
- [ ] インストールプロンプト
- [ ] パフォーマンス最適化
- [ ] バッテリー消費最適化

### Phase 6: 追加機能 随時
- [ ] 準備リストチェックリスト
- [ ] 保冷剤リマインダー
- [ ] 音声ガイド（オプション）
- [ ] 多言語対応
- [ ] マルチユーザー対応

---

## 🎯 差別化ポイント

1. **科学的根拠**: 実際の熱力学計算に基づいた正確な予測
2. **材質対応**: ガラス/プラスチックで異なる冷却時間を考慮
3. **氷水攪拌の最適化**: 最も実用的な方法に特化した機能
4. **直感的な温度表現**: 哺乳瓶イラストで温度変化を視覚化
5. **揺らしガイド**: 15秒ごとのリマインダーで最適な冷却
6. **節水重視**: 環境に配慮した冷却方法の推奨
7. **学習機能**: 使うほど環境に適応し精度向上
8. **夜間対応**: ダークモード、直感的UI

---

## 🎨 デザインモックアップ（イメージ）

### タイマー画面の温度表現
```
46°C: 🍼 ← 濃いオレンジ
      ┌───┐
      │🟠🟠│
      │🟠🟠│
      │🟠🟠│
      └───┘

42°C: 🍼 ← だんだん薄く
      ┌───┐
      │🟡🟡│
      │🟡🟡│
      │🟠🟠│
      └───┘

38°C: 🍼 ← グリーンで完成
      ┌───┐
      │🟢🟢│
      │🟢🟢│
      │🟢🟢│
      └───┘
```

---

## ❓ 検討事項・課題

### 精度向上のために
- 実測データの収集方法
- ユーザーフィードバックの反映仕組み
- 環境要因（湿度、風、水量）の考慮
- 保冷剤の個数・種類による違い

### UX改善のために
- 片手操作の最適化（親指が届く範囲）
- 揺らしタイミングの最適な間隔
- 音声ガイドの必要性
- タイマー途中でのアプリ切り替え対応

### 技術的課題
- バックグラウンドでの正確なタイマー動作
- バイブレーションのバッテリー消費
- SVGアニメーションのパフォーマンス
- 履歴データの肥大化対策

### 氷水攪拌モード特有の課題
- 揺らし忘れの検知
- 揺らし強度の考慮（できない）
- 氷が溶けた場合の温度変化

---

## 📝 次のステップ

1. ✅ 企画書の完成
2. ⬜ 技術スタックの最終決定
3. ⬜ デザインモックアップ作成（Figma）
4. ⬜ 開発環境構築（Claude Code）
5. ⬜ 熱力学計算エンジンの実装とテスト
6. ⬜ MVP開発開始

---

## 💬 フィードバック・改善案

この企画書を元に、以下を検討してください：

- 優先的に実装したい機能は？
- 不要な機能はある？
- 追加したい冷却方法は？
- デザインのイメージに合わない部分は？

---

**更新履歴**
- v2.0: 氷水冷却方法追加、ビジュアル表現強化、揺らしリマインダー機能追加
- v1.0: 初版作成